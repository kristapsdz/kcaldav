<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<meta charset="utf-8" /> 
		<title>kcaldav: @@name@@</title>
		<link rel="stylesheet" href="@@hturi@@/style.css" type="text/css" />
		<script src="@@hturi@@/md5.js"></script>
		<script>
			function updatehash(input) {
				var e = document.getElementById('password');
				if ('' == input.value)
					e.value = '';
				else 
					e.value = md5('@@name@@:@@realm@@:' + input.value);
			}
		</script>
	</head>
	<body>
		<header>
			<h1>
				<a href="@@page-home@@">CalDAV</a> Management
			</h1>
		</header>
		<article>
			<p>
				Welcome, @@name@@.
				This is your online administrative interface to the <a href="http://kristaps.bsd.lv/kcaldav"><i>k</i>CalDAV</a> installation.
				<span class="@@class-readonly@@">
					The database is <strong>read-only</strong>, so you won't be able to change anything.
				</span>
				<span class="@@class-writable@@">
					<span class="@@class-insecure@@">
						This connection is <strong>not secure</strong>, so consider that your password hash is being sent in the clear!
					</span>
				</span>
			</p>
			<div class="error" id="error">
				Something strange and unknown has gone wrong.
				Contact your administrator.
			</div>
			<section>
				<h2>
					Your CalDAV Address
				</h2>
				<div class="input single">
					<input disabled="disabled" type="text" value="@@uri@@"/>
				</div>
			</section>
			<section>
				<h2>
					Your E-mail Address
				</h2>
				<div class="error" id="setemail-error">
					Do e-mail addresses look like that where you come from?
				</div>
				<div class="error" id="setemail-ok">
					Your e-mail address has been reset.
				</div>
				<form action="@@page-email@@" method="post" class="@@class-writable@@">
					<div class="input double">
						<input value="@@email@@" name="@@valid-email@@" type="email"/>
						<input value="Change E-mail" type="submit"/>
					</div>
				</form>
				<div class="input single @@class-readonly@@">
					<input value="@@email@@" disabled="disabled" type="email"/>
				</div>
			</section>
			<section class="@@class-writable@@">
				<h2>
					Your Password
				</h2>
				<div class="input single">
					<input placeholder="Enter Password" type="password" onkeyup="updatehash(this);" />
				</div>
				<div>
					<noscript>
						You don't have JavaScript enabled, so you'll need to manually MD5 hash the string
						<kbd>@@name@@:@@realm@@:<i>password</i></kbd>.
					</noscript>
					<script>
						document.write('...will be hashed into the input box below.');
					</script>
					No passwords are stored on <a href="http://kristaps.bsd.lv/kcaldav"><i>k</i>CalDAV</a> servers.
					You'll be logged out if you change your password.
				</div>
				<div class="error" id="setpass-error">
					If you call that a password, I've a bridge to sell you.
					Try again.
				</div>
				<div class="error" id="setpass-ok">
					Your password has been reset.
				</div>
				<form action="@@page-pass@@" method="post">
					<div class="input double">
						<input name="@@valid-pass@@" id="password" type="text" />
						<input value="Change Password" type="submit"/>
					</div>
				</form>
			</section>
		</article>
		<footer>
			&copy; 2015 <a href="http://kristaps.bsd.lv">Kristaps Dzonsons</a>
		</footer>
	</body>
</html>
